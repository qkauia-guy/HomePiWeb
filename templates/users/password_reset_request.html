{% extends "base.html" %}
{% load static %}
{% block title %}忘記密碼{% endblock %}

{% block content %}
<div class="container py-4 py-md-5">
  <div class="row justify-content-center">
    <div class="col-11 col-sm-10 col-md-7 col-lg-5 col-xl-4">
      <div class="card shadow-sm rounded-4">
        <div class="card-body p-4 p-md-5">
          <h1 class="h4 brand mb-4 text-center text-md-start">忘記密碼</h1>

          <p class="text-muted mb-3">輸入你的 Email，我們會提供重設連結。</p>

          <form method="post" id="reset-form" novalidate>
            {% csrf_token %}
            <div class="mb-3">
              <label for="id_email" class="form-label">Email</label>
              <input type="email"
                     id="id_email"
                     name="email"
                     class="form-control"
                     placeholder="you@example.com"
                     autocomplete="email"
                     inputmode="email"
                     required autofocus>
            </div>

            <div class="mt-4">
              <div class="mb-3 text-center text-sm-start">
                <a href="{% url 'login' %}" class="text-decoration-underline">回登入</a>
              </div>
              <div>
                <button type="submit" class="btn btn-primary w-100 w-sm-auto" id="reset-btn">
                  送出
                </button>
              </div>
            </div>
          </form>

          {% if reset_url %}
            <div class="alert alert-success mt-4 mb-0">
              <div class="mb-1 fw-semibold">重設連結（開發/內部用）：</div>
              <div class="d-flex align-items-start gap-2">
                <textarea id="reset-link-text"
                          class="form-control form-control-sm text-break small"
                          rows="2" readonly>{{ reset_url }}</textarea>
                <button type="button" class="btn btn-outline-success btn-sm flex-shrink-0" id="copy-link">
                  複製
                </button>
              </div>
            </div>
          {% endif %}

        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block extra_js %}
  <script defer src="{% static 'users/js/password_reset_request.js' %}"></script>
{% endblock %}
