{# templates/home/partials/_group_items.html #}
{% comment %} 需要變數 groups（建議在 view 註解 device_count；否則可用 g.devices.count） {% endcomment %}

{% url 'home' as home_url %}
{% url 'group_list' as group_list_url %}

{% if groups and groups|length > 0 %}
  <div class="device-list list-group">
    <a href="{% url 'group_create' %}" class="btn btn-success mb-2 w-100">+ 建立群組</a>
    <a href="{{ group_list_url }}" class="btn btn-primary mb-2 w-100">前往群組管理</a>

    {% for g in groups %}
      {% with count=g.device_count|default:g.devices.count %}
      <a href="{{ home_url }}?g=g{{ g.id }}"
         class="device-item list-group-item list-group-item-action d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center gap-3">
          {# 狀態點：有裝置就亮綠；無裝置維持灰點 #}
          <span class="status-dot {% if count %}on{% endif %}" aria-hidden="true"></span>
          <div>
            <div class="fw-semibold">{{ g.name }}</div>
            <div class="device-sub small text-body-secondary">
              共 {{ count|default:0 }} 台裝置
            </div>
          </div>
        </div>
        <span class="chev" aria-hidden="true">›</span>
      </a>
      {% endwith %}
    {% endfor %}
  </div>
{% else %}
  <p class="text-muted mb-2">尚無群組</p>
  <a href="{{ group_list_url }}" class="btn btn-success w-100">建立群組</a>
{% endif %}
