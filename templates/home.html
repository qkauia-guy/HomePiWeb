{% extends "base.html" %}

{% block title %}é¦–é {% endblock %}

{% block content %}
  <div class="container mt-4">
    <h2>ğŸ‘‹ æ­¡è¿å›ä¾† {{ user.email }}</h2>

    {% if user.is_superadmin %}
      <div class="alert alert-success">æ‚¨æ˜¯ SuperAdminï¼Œå¯ä»¥ç®¡ç†æ‰€æœ‰è¨­å‚™èˆ‡ä½¿ç”¨è€…ã€‚</div>
    {% elif user.is_admin %}
      <div class="alert alert-info">æ‚¨æ˜¯ Adminï¼Œæ“æœ‰ç®¡ç†æ¬Šé™ã€‚</div>
    {% else %}
      <div class="alert alert-secondary">æ‚¨æ˜¯ä¸€èˆ¬ä½¿ç”¨è€…ã€‚</div>
    {% endif %}
  </div>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const serial = "{{ request.user.device.serial_number|default:'' }}";
    if (serial) {
      fetch("/api/device/ping/", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ serial_number: serial }),
      })
      .then((res) => res.json())
      .then((data) => {
        console.log("è¨­å‚™ç‹€æ…‹ï¼š", data);
      })
      .catch((err) => console.error("Ping å¤±æ•—", err));
    }
  });
</script>
{% endblock %}
