[Unit]
Description=HomePi HTTP Agent
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=%i
Group=%i
WorkingDirectory=/home/%i/pi_agent
EnvironmentFile=/home/%i/pi_agent/.env
Environment=PYTHONUNBUFFERED=1
ExecStart=/usr/bin/python3 /home/%i/pi_agent/http_agent.py

Restart=always
RestartSec=3
NoNewPrivileges=yes
PrivateTmp=yes
ProtectSystem=full

[Install]
WantedBy=multi-user.target